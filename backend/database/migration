package main

import (
	"database/sql"

	_ "github.com/mattn/go-sqlite3"
)

// func untuk migrasi ke db
func main() {
	db, err := sql.Open("sqlite3", "backend/database/booking.db")
	if err != nil {
		panic(err)
	}

	_, err = db.Exec(`
		CREATE TABLE IF NOT EXISTS role (
			id_role INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
			role VARCHAR(50)
		);

		CREATE TABLE IF NOT EXISTS kelas (
			id_kelas INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
			kelas VARCHAR(50)
		);


		CREATE TABLE IF NOT EXISTS USER (
			id_user INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
			username VARCHAR(50),
			password TEXT,
			nama_lengkap VARCHAR(50),
			gender VARCHAR(50),
			usia INT,
			alamat TEXT,
			email VARCHAR(50),
			no_tlp INT,
			FOREIGN KEY(id_role) REFERENCES role(id_role)
		);


		CREATE TABLE IF NOT EXISTS transaksi (
			id_transaksi INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
			id_user INT,
			status VARCHAR(50),
			tgl DATE,
			FOREIGN KEY(id_user) REFERENCES guru(id_user),
		);

		CREATE TABLE IF NOT EXISTS review (
			id_review INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
			id_guru INT,
			id_siswa INT,
			review VARCHAR(50),
			tgl DATE,
			FOREIGN KEY(id_guru) REFERENCES guru(id_guru),
			FOREIGN KEY(id_siswa) REFERENCES siswa(id_siswa)
		);

		INSERT INTO role
			(role)
		VALUES
			('user');

		INSERT INTO kelas
			(kelas, tarif);
		

		INSERT INTO user
			(username, password, nama_lengkap, gender, usia, alamat, email, no_tlp, id_role)
		VALUES
			('john', '1234', 'john dev', 'pria', 17, 'Bandung', 'john@gmail.com', 08123454422, 2);
		

		INSERT INTO transaksi
			(id_user, status, tgl)
		VALUES
			('1', 'mendaftar', '19-06-2022'),
			('2', 'selesai', '22-06-2022');
		
		INSERT INTO review
			(id_user, review, tgl)
		VALUES
			('1', 'ruang kelasnya bersih', '19-06-2022'),
			('2', 'ruangan nya luas', '22-06-2022');

	`)

	if err != nil {
		panic(err)

	}
}
